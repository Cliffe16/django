{% extends 'base.html' %}

{% block content %}
  <div class="custom-title">
    <h1>SugarQube Dashboard</h1>
  </div>
  
  <div class="kpi-container">
    <div class="kpi-box">
      <h4>Today's Price</h4>
      <div class="kpi-value">{{ today_price }}</div>
    </div>
    <div class="kpi-box">
      <h4>Yesterday's Price</h4>
      <div class="kpi-value">{{ yesterday_price }}</div>
    </div>
    <div class="kpi-box">
      <h4>% Change</h4>
      <div class="kpi-value">{{ percentage_change }}%</div>
    </div>
  </div>
  
  <div id="chart-container" style="width:100%; height:400px; margin-top: 20px;"></div>
{% endblock %}


{% block javascript %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
      fetch("{% url 'sugar-price-data' %}")
          .then(response => response.json())
          .then(data => {
              Highcharts.chart('chart-container', {
                  chart: { type: 'line' },
                  title: { text: 'Sugar Prices' },
                  xAxis: { type: 'datetime', title: { text: 'Date' } },
                  yAxis: { title: { text: 'Price' } },
                  series: [{
                      name: 'Average Sugar Price',
                      data: data
                  }]
              });
          });
  });
</script>
{% endblock %}